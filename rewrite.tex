\documentclass{ck-article}

\title{Hochschild cohomology of torus equivariant D-modules: New approach}
\author{Clemens Koppensteiner}

\usepackage{math-ag}
\addbibresource{math.bib}

\newcommand\bc{\textbf{($\mathbf{*}$)}}
\newcommand\hbc{\textbf{($\mathbf{**}$)}}

\newcommand\cs{\stack{B}}
\newcommand\catCoSimplicial{\cat{\Delta}^{\mathrm{op}}}
\newcommand\dR{\mathrm{dR}}
\newcommand\GammadR{Γ_{\mkern-4mu\dR}}
\newcommand{\HCoh}{\operatorname{HH}^\cx}   % Hochschild cohomology
\newcommand\opalg[1]{#1^{\mathrm{op}}}

\begin{document}
\maketitle

\section{Base change along the diagonal}

\begin{Def}
    Let $\stack X$ be any QCA stack.
    Consider the Cartesian diagram
    \[
        \begin{tikzcd}
            \ls \stack X \arrow[d, "p_1"] \arrow[r, "p_2"] & \stack X \arrow[d, "\Delta"] \\
            \stack X \arrow[r, "\Delta"] & \stack X \times \stack X
        \end{tikzcd}
    \]
    We say that $\stack X$ has property \bc\ if the canonical morphism
    \[
        p_{1,!}p_2^! \to \Delta^!\Delta_!
    \]
    of endofunctors of $\catDModHol{\stack X}$ is an equivalence.
\end{Def}

Let us write $\stack G_\bullet = \stack G_\bullet(\stack X)$ for the nerve of the groupoid associated to $\ls\stack X \rightrightarrows \stack X$.
Thus
\[
    \stack G_m(\stack X) = \underbrace{\stack X \times_{\stack X \times \stack X} \dotsb \times_{\stack X \times \stack X} \stack X}_{m+1\text{ times}}.
\]

\begin{Def}
    Let $\stack X$ be a QCA stack and consider the cartesian square
    \[
        \begin{tikzcd}
            \stack G_{n+1} \arrow[r, "p_{s}"] \arrow[d, "p_{F+1}"] & \stack G_n \arrow[d, "p_F"] \\
            \stack G_{m+1} \arrow[r, "p_s"] & \stack G_m
        \end{tikzcd}
    \]
    where the horizontal maps are induced by a map $F\colon [n] \to [m]$ in $\catCoSimplicial$.
    We say that $\stack X$ has property \hbc\ if for each such $F$ the canonical morphism
    \[
        p_{F+1,!}p_s^! \to p_s^!p_{F,!}
    \]
    of functors $\catDModHol{\stack G_n} \to \catDModHol{\stack G_{m+1}}$ is an equivalence.
\end{Def}

\begin{Cor}\label{cor:properties_imply_monads}
    If $\stack X$ has properties \bc\ and \hbc, then there exists a canonical structure of monad on $p_{1,!}p₂^!$ and the morphism $p_{2,!}p₁^! → Δ^!Δ_!$ is an isomorphism of monads.
    In particular there is an isomorphism of algebras
    \[
        \HCoh\bigl(\catDMod{\stack X}\bigr)
        \cong
        \opalg{\GammadR\bigl(\stack X,\, p_{1,!} p₂^! k_{\stack X}\bigr)}.
    \]
\end{Cor}

\begin{proof}
    This is just a restatement of Lemma~\ref{lem:pre:groupoid_monad_hol} together with ?.
\end{proof}

\begin{Rem}
    We expect that most quotient stacks do not have property \bc.
    For example, a direct computation shows that the transformation of property \bc\ is not an isomorphism for the D-module $k$ on the stack $\ps1/\Ga$.
\end{Rem}

\begin{Lem}\label{lem:smooth_or_proper}
    Let $\stack X$ be a QCA stack with diagonal morphism $\Delta\colon \stack X \to \stack X \times \stack X$. Then,
    \begin{enumerate}
        \item\label{lem:smooth_or_proper:bc} If $\Delta$ is either proper of smooth, then $\stack X$ has property \bc.
        \item\label{lem:smooth_or_proper:hbc} If $\Delta$ is proper, then $\stack X$ has property \hbc.
        \item\label{lem:smooth_or_proper:scheme} If $\stack X$ is a (separated) scheme, then $\stack X$ has both properties \bc\ and \hbc.
        \item\label{lem:smooth_or_proper:bg} Let $G$ be an affine algebraic group. Then the classifying stack $\cs{G}$ has both properties \bc\ and \hbc.
    \end{enumerate}
\end{Lem}

\begin{proof}
    Statement \ref{lem:smooth_or_proper:bc} is a direct consquence of the base change theorem [reference].

    We only need to show \ref{lem:smooth_or_proper:hbc} under the additional assumption that $F$ is a face or degeneracy map.
    In either case it follows immediately that $p_{F}$ is proper and we can again apply base change.

    Statement \ref{lem:smooth_or_proper:scheme} is just a special case of \ref{lem:smooth_or_proper:bc} and \ref{lem:smooth_or_proper:hbc}.
    
    The diagonal morphism of $\cs{G}$ is smooth, so that property \hbc\ follows from \ref{lem:smooth_or_proper:bc}.
    Note that $\stack G_m(\cs{G}) \cong G^m \times \cs{G}$.
    Thus one sees that the maps $\stack G_m(\cs{G}) \to \stack G_{m-1}(\cs{G})$ are smooth, while the maps $\stack G_m(\cs{G}) \to \stack G_{m+1}(\cs{G})$ are closed immersions (and hence proper).
    Thus property \hbc\ follows from smooth and proper base change.
\end{proof}

\subsection{Some reduction steps}

Let $i\colon\stack Y \to \stack X$ be an open (or closed) immersion.
We have $\ls Y \cong \stack Y \times_{\stack X \times \stack X} \stack Y$ and it follows that there is a canonical open (resp.~closed) immersion of loop stacks $\ls i\colon \ls \stack Y \to \ls \stack X$.

More generally, $\stack G_m(\stack Y)$ is an open (resp.~closed) substack of $\stack G_m(\stack X)$.
Absuing notation, we will sometimes continue to denote this inclusion by $i$.
%In the special case $m=1$, we will also write $\ls i\colon \ls \stack Y \to \ls \stack X$.

\begin{Lem}\label{lem:lc_immersion}
    Let $i\colon\stack Y \hookrightarrow \stack X$ is a locally closed immersion of QCA stacks.
    If $\stack X$ has property \bc\ (resp.~property \hbc), then so does $\stack Y$.
\end{Lem}

\begin{proof}
    We will show the statement for property \bc.
    The proof for \hbc\ is essentally the same.
    Let us first assume that $i$ is open.
    It suffices to show that $p_{\stack Y,1,!}p_{\stack Y,2}^!i^! \to \Delta_{\stack Y}^!\Delta_{\stack Y,!}i^!$ is an equivalence.
    Now, using the assumption on $\stack X$ and the fact that $i^! = i^*$ we get
    \[
        p_{\stack Y,1,!} p_{\stack Y,2}^!i^! =
        p_{\stack Y,1,!} (\ls i)^! p_{\stack X,2}^! \cong
        i^! p_{\stack X,1,!} p_{\stack X,2}^! \isoto
        i^! \Delta_{\stack X}^! \Delta_{\stack X,!} =
        \Delta_{\stack Y}^! (i\times i)^! \Delta_{\stack X,!} \cong
        \Delta_{\stack Y}^! \Delta_{\stack X,!} i^!.
    \]
    Now let $i$ be a closed immersion.
    As above, it suffices to show that $i_!p_{\stack Y,1,!}p_{\stack Y,2}^!i^! \to i_!\Delta_{\stack Y}^!\Delta_{\stack Y,!}i^!$ is an equivalence.
    Now, using the assumption on $\stack X$ and the fact that $i_! = i_*$ we get
    \[
        i_! p_{\stack Y,1,!} p_{\stack Y,2}^!i^! =
        p_{\stack X,1,!} (\ls i)_! p_{\stack Y,2}^!i^! \cong
        p_{\stack X,1,!} p_{\stack X,2}^! i_!i^! \isoto
        \Delta_{\stack X}^! \Delta_{\stack X,!} i_!i^! \cong
        \Delta_{\stack Y}^! (i\times i)_! \Delta_{\stack X,!}i^! =
        i_! \Delta_{\stack Y}^! \Delta_{\stack X,!} i^!.
        \qedhere
    \]
\end{proof}

Since all operations are local we can check the properties on open covers.

\begin{Lem}\label{lem:open_cover}
    If $\stack X$ has an open cover by substacks $\stack U_i$ with property \bc\ (resp.~with property \hbc), then $\stack X$ has property \bc\ (resp.~property \hbc).
\end{Lem}

\begin{Lem}\label{lem:product}
    If $\stack{X_1}$ and $\stack{X_2}$ both have property \bc\ (resp.~property \hbc), then so does $\stack{X_1} \times \stack{X_2}$.
\end{Lem}

\begin{proof}
    The category $\catDMod{\stack X_1 \times \stack X_2}$ is generated by elements of the form $\sheaf F_1 \boxtimes \sheaf F_2$ with $\sheaf F_i \in \catDModHol{\stack X_i}$.
    For any schematic morphism $f\colon \stack Y \to \stack Z$ of QCA stacks the functor $f^!$ is continuous on $\catDMod{\stack Z}$ and $f_!$ is preservers colimits in $\catDModHol{\stack Y}$, since it has a right adjoint.
    Since the inclusion of a full subcategory reflects all colimits it is thus sufficient to check that the properties holds on elements of the form $\sheaf F_1 \boxtimes \sheaf F_2 \in \catDModHol{\stack X_1 \times \stack X_2}$.
    
    Note that $\ls(\stack X_1 \times \stack X_2) \cong \ls \stack X_1 \times \ls \stack X_2$ and more generally $\stack G_m(\stack X_1 \times \stack X_2) \cong \stack G_m(\stack X_1) \times \stack G_m(\stack X_2)$.
    The statement now follows because all functors respect $\boxtimes$.
\end{proof}

\subsection{Contractive \texorpdfstring{$\Gm$}{Gm}-actions}

Let $\stack X$ be a QCA stack with an action of $\Gm$.
We call the action \emph{contractive} if it can be extended to an action of the monoid $\as 1$.
Following the convention of \cite[Appendix~C]{DrinfeldGaitsgory:arXiv:CompactGenerationOfDModOnBunG} we denote by $\stack X^0$ the stack of $\{0,1\}$-equivariant maps $\{0\} \to \stack X$.
The map $\{0\} \to \{0,1\}$ induces a \emph{contraction morphism} $\pi\colon \stack X \to \stack X^0$.

We then have the following \emph{contraction principle} (cf.~also \cite[Proposition~3.2.2]{DrinfeldGaitsgory:2014:OnATheoremOfBraden}).

\begin{Thm}[{\cite[Corollary~C.5.4]{DrinfeldGaitsgory:arXiv:CompactGenerationOfDModOnBunG}}]
    \label{thm:contraction_principle}%
    Let $X$ be a scheme with a trivial contractive $\Gm$-action.
    Then there is a canonical isomorphism of functors
    \[
        π_! \cong i^! \colon \catDModHol{\stack X} → \catDModHol{\stack X^0}
    \]
    given by adjunction
    \[
        π_! → i^! i_! π_!  = i^! (π ∘ i)_! = i^!.
    \]
\end{Thm}

\begin{Prop}\label{prop:contractive}
    Assume that $\stack X$ has a trivial contractive $\Gm$-action such that $i\colon \stack X^0 \to \stack X$ is a closed immersion and both $\stack X^0$ and $\stack U = \stack X\setminus \stack X^0$ have property \bc\ (respectively property \hbc).
    Then so does $\stack X$.
\end{Prop}

\begin{proof}
    Let us first prove the statement for property \bc.
    Let $j\colon \stack U \hookrightarrow \stack X$ be the (open) complement of $i$.
    Consider the distinguished triangle
    \[
        i_!i^! \Delta^!\Delta_! \to \Delta^!\Delta_! \to j_*j^*\Delta^!\Delta_!
    \]
    on $\catDModHol{\stack X}$.
    It suffices to show that the canonical maps on the outside terms to $i_!i^! p_{1,!}p_2^!$ and $j_*j^* p_{1,!}p_2^!$ are isomorphisms.
    
    Using the fact that $j^* = j^!$, base change and the assumption we see that
    \[
        j_*j^*\Delta^!\Delta_! \cong
        j_*\Delta^!\Delta_!j^* \isoto
        j_*p_{\stack U,1,!}p_{\stack U,2}^! j^* \cong
        j_*j^* p_{1,!}p_2^!
    \]
    is an equivalence.

    Write $\pi\colon \stack X \to \stack X^0$ for the contraction map opposite to $i$.
    Then by the contraction principle,
    \begin{equation}\label{eq:lem:bc_contractive}
        i_!i^! \Delta^!\Delta_! =
        i_!\Delta_{\stack X_0}^!(i\times i)^! \Delta_! \cong
        i_!\Delta_{\stack X_0}^!(\pi\times \pi)_! \Delta_! =
        i_!\Delta_{\stack X_0}^!\Delta_{\stack X_0,!} \pi_! \cong
        i_!\Delta_{\stack X_0}^!\Delta_{\stack X_0,!} i^!.
    \end{equation}
    Write $\ls i \colon \ls\stack X^0 \hookrightarrow \ls\stack X$ for the corresponding closed inclusion of loop stacks.
    We note that $\ls\stack X$ inherits a contractive $\Gm$ action form $\stack X$.
    Let $\ls \pi\colon \ls\stack X \to \ls\stack X^0$ be the corresponding contraction map.
    Then by assumption and the contraction principle (Theorem~\ref{thm:contraction_principle}), \eqref{eq:lem:bc_contractive} is equivalent to
    \[
        i_!p_{\stack X_0,1,!}p_{\stack X_0,2}^! i^! =
        i_!p_{\stack X_0,1,!} (\ls i)^! p_{2}^! \cong
        i_!p_{\stack X_0,1,!} (\ls \pi)_! p_{2}^! =
        i_! \pi_! p_{1,!} p_{2}^! =
        i_! i^! p_{1,!} p_{2}^!.
    \]
    Finally, we note that the $\Gm$-action on $\stack X$ induces contractive $\Gm$-actions on each $\stack G_m(\stack X)$ with $(\stack G_m(\stack X))^0 = \stack G_m(\stack X^0)$.
    Thus the statement for property \hbc\ follows in the same way as above.
\end{proof}

\section{Torus quotients}

\begin{Thm}
    Let $X$ be a normal variety with an action of a torus $T$.
    Then $\stack X = X/T$ has properties \bc\ and \hbc.
\end{Thm}

\begin{proof}
    By Sumihiro's theorem \cite{Sumihiro:1974:EquivariantCompletions} and Lemma~\ref{lem:open_cover} we can assume that $\stack X$ is affine with a linear action of $T$.
    By Lemma~\ref{lem:lc_immersion} it further suffices to consider the case that $\stack X = \as{m}/T$ for some $n$.
    By Lemma~\ref{lem:product}, we can further decompose $\as{m}$ into $T$-eigenspaces.
    Each of those splits into copies of $\as{1}/T \cong \as{1}/\Gm \times BT'$.
    
    By Lemma~\ref{lem:smooth_or_proper} it remains to consider the stack $\as{1}/\Gm$, where $\Gm$ acts nontrivially.
    If the $\Gm$ action is contractive this case follows immediately from Proposition~\ref{prop:contractive} and Lemma~\ref{lem:smooth_or_proper}.
    Otherwise the inverse of the $\Gm$-action on $\as1$ is contractive and we can use the contraction principle (and hence Proposition~\ref{prop:contractive}) with the monoid $\as1 = \Gm \cup \{\infty\}$ instead of $\Gm \cup \{0\}$.
\end{proof}


\printbibliography

\end{document}
